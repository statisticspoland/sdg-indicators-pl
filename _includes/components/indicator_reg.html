{% assign table_template = 'components/table1.html' %}
{% assign id = page.indicator | slugify %}
{% assign id_map = id | replace: '-reg', '' %}

{% assign slug = page.indicator | replace: '.', '-' %}
{% assign t1 = site.metadane_regionalne | where:"translation_id", slug | first %}

<div class="tab-content">
  <div role="tabpanel" class="tab-pane active" id="data">
    <div style="display: flow-root;">
    {% if page.graph == 'bar' or page.graph == 'longitudinal' or page.graph == 'scatter'%}

      {% assign graph_type = page.graph %}

      {% if page.graph == 'longitudinal' %}
        {% assign graph_type = 'line' %}
      {% endif %}

      {% assign graph_template = 'components/' | append: graph_type | append: '.html' %}
      {% assign indicator_template = 'components/indicator1' | append: '.html' %}

      <script src="https://cdn.amcharts.com/lib/5/index.js"></script>
      <script src="https://cdn.amcharts.com/lib/5/xy.js"></script>
      <script src="https://cdn.amcharts.com/lib/5/themes/Animated.js"></script>
      <script src="https://cdn.amcharts.com/lib/5/locales/pl_PL.js"></script>
      <script src="https://cdn.amcharts.com/lib/5/map.js"></script>
      <script src="https://cdn.amcharts.com/lib/5/geodata/polandLow.js"></script>
      <script type="text/javascript" src="{{ site.baseurl }}/assets/js/amchart5/wojewodztwaMapReg.js"></script>
      <script type="text/javascript" src="{{ site.baseurl }}/assets/js/amchart5/reg/line.js"></script>
      <script type="text/javascript" src="{{ site.baseurl }}/assets/js/amchart5/reg/bar.js"></script>

      <div style="width: 15%; display: inline-block; margin-top: 6px; margin-left: 5px; vertical-align: top;">
<!--         <label for="years" style="margin: 10px; max-width: 100px; display: inline; font-weight: normal;">
        {% if language == 'pl' %}
          Rok:
        {% else %}
          Year:
        {% endif %}
        </label>
 -->
          {% if id_map == '1-a-4' %}
          <select id="yearBox" onchange="wyborYear()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51); font-size: 14px;">
            <option style="font-family: Fira Sans" value="2023" selected>2023</option>
            <option style="font-family: Fira Sans" value="2022">2022</option>
            <option style="font-family: Fira Sans" value="2021">2021</option>
            <option style="font-family: Fira Sans" value="2020">2020</option>
            <option style="font-family: Fira Sans" value="2019">2019</option>
            <option style="font-family: Fira Sans" value="2018">2018</option>
            <option style="font-family: Fira Sans" value="2017">2017</option>
            <option style="font-family: Fira Sans" value="2016">2016</option>
            <option style="font-family: Fira Sans" value="2015">2015</option>
          </select>
          {% elsif id_map == '1-b-2' %}
          <select id="yearBox" onchange="wyborYear()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
            <option style="font-family: Fira Sans" value="2023" selected>2023</option>
            <option style="font-family: Fira Sans" value="2022">2022</option>
          </select>
          {% elsif id_map == '1-b-4' %}
          <select id="yearBox" onchange="wyborYear()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
            <option style="font-family: Fira Sans" value="2024" selected>2024</option>
            <option style="font-family: Fira Sans" value="2023">2023</option>
            <option style="font-family: Fira Sans" value="2022">2022</option>
            <option style="font-family: Fira Sans" value="2021">2021</option>
            <option style="font-family: Fira Sans" value="2020">2020</option>
            <option style="font-family: Fira Sans" value="2019">2019</option>
            <option style="font-family: Fira Sans" value="2018">2018</option>
            <option style="font-family: Fira Sans" value="2017">2017</option>
            <option style="font-family: Fira Sans" value="2016">2016</option>
            <option style="font-family: Fira Sans" value="2015">2015</option>
            <option style="font-family: Fira Sans" value="2014">2014</option>
            <option style="font-family: Fira Sans" value="2013">2013</option>
            <option style="font-family: Fira Sans" value="2012">2012</option>
            <option style="font-family: Fira Sans" value="2011">2011</option>
          </select>
          {% elsif id_map == '1-b-5' %}
          <select id="yearBox" onchange="wyborYear()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
            <option style="font-family: Fira Sans" value="2024" selected>2024</option>
            <option style="font-family: Fira Sans" value="2023">2023</option>
            <option style="font-family: Fira Sans" value="2022">2022</option>
            <option style="font-family: Fira Sans" value="2021">2021</option>
            <option style="font-family: Fira Sans" value="2020">2020</option>
            <option style="font-family: Fira Sans" value="2019">2019</option>
            <option style="font-family: Fira Sans" value="2018">2018</option>
            <option style="font-family: Fira Sans" value="2017">2017</option>
            <option style="font-family: Fira Sans" value="2016">2016</option>
            <option style="font-family: Fira Sans" value="2015">2015</option>
            <option style="font-family: Fira Sans" value="2014">2014</option>
            <option style="font-family: Fira Sans" value="2013">2013</option>
            <option style="font-family: Fira Sans" value="2012">2012</option>
            <option style="font-family: Fira Sans" value="2011">2011</option>
            <option style="font-family: Fira Sans" value="2010">2010</option>
          </select>
          {% elsif id_map == '1-b-7' %}
          <select id="yearBox" onchange="wyborYear()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
            <option style="font-family: Fira Sans" value="2023" selected>2023</option>
            <option style="font-family: Fira Sans" value="2022">2022</option>
            <option style="font-family: Fira Sans" value="2021">2021</option>
            <option style="font-family: Fira Sans" value="2020">2020</option>
            <option style="font-family: Fira Sans" value="2019">2019</option>
            <option style="font-family: Fira Sans" value="2018">2018</option>
            <option style="font-family: Fira Sans" value="2017">2017</option>
            <option style="font-family: Fira Sans" value="2016">2016</option>
          </select>
          {% elsif id_map == '1-b-8' %}
          <select id="yearBox" onchange="wyborYear()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
            <option style="font-family: Fira Sans" value="2023" selected>2023</option>
            <option style="font-family: Fira Sans" value="2022">2022</option>
            <option style="font-family: Fira Sans" value="2021">2021</option>
            <option style="font-family: Fira Sans" value="2020">2020</option>
            <option style="font-family: Fira Sans" value="2019">2019</option>
            <option style="font-family: Fira Sans" value="2018">2018</option>
            <option style="font-family: Fira Sans" value="2017">2017</option>
          </select>
          {% elsif id_map == '1-c-1' %}
          <select id="yearBox" onchange="wyborYear()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
            <option style="font-family: Fira Sans" value="2024" selected>2024</option>
            <option style="font-family: Fira Sans" value="2023">2023</option>
            <option style="font-family: Fira Sans" value="2022">2022</option>
            <option style="font-family: Fira Sans" value="2021">2021</option>
            <option style="font-family: Fira Sans" value="2020">2020</option>
            <option style="font-family: Fira Sans" value="2019">2019</option>
            <option style="font-family: Fira Sans" value="2018">2018</option>
            <option style="font-family: Fira Sans" value="2017">2017</option>
            <option style="font-family: Fira Sans" value="2016">2016</option>
            <option style="font-family: Fira Sans" value="2015">2015</option>
            <option style="font-family: Fira Sans" value="2014">2014</option>
            <option style="font-family: Fira Sans" value="2013">2013</option>
            <option style="font-family: Fira Sans" value="2012">2012</option>
            <option style="font-family: Fira Sans" value="2011">2011</option>
            <option style="font-family: Fira Sans" value="2010">2010</option>
          </select>
          {% elsif id_map == '1-c-2' %}
          <select id="yearBox" onchange="wyborYear()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
            <option style="font-family: Fira Sans" value="2024" selected>2024</option>
            <option style="font-family: Fira Sans" value="2023">2023</option>
            <option style="font-family: Fira Sans" value="2022">2022</option>
            <option style="font-family: Fira Sans" value="2021">2021</option>
            <option style="font-family: Fira Sans" value="2020">2020</option>
            <option style="font-family: Fira Sans" value="2019">2019</option>
            <option style="font-family: Fira Sans" value="2018">2018</option>
            <option style="font-family: Fira Sans" value="2017">2017</option>
            <option style="font-family: Fira Sans" value="2016">2016</option>
            <option style="font-family: Fira Sans" value="2015">2015</option>
            <option style="font-family: Fira Sans" value="2014">2014</option>
            <option style="font-family: Fira Sans" value="2013">2013</option>
            <option style="font-family: Fira Sans" value="2012">2012</option>
            <option style="font-family: Fira Sans" value="2011">2011</option>
            <option style="font-family: Fira Sans" value="2010">2010</option>
          </select>
          {% elsif id_map == '1-c-3' %}
          <select id="yearBox" onchange="wyborYear()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
            <option style="font-family: Fira Sans" value="2024" selected>2024</option>
            <option style="font-family: Fira Sans" value="2023">2023</option>
            <option style="font-family: Fira Sans" value="2022">2022</option>
            <option style="font-family: Fira Sans" value="2021">2021</option>
            <option style="font-family: Fira Sans" value="2020">2020</option>
            <option style="font-family: Fira Sans" value="2019">2019</option>
            <option style="font-family: Fira Sans" value="2018">2018</option>
            <option style="font-family: Fira Sans" value="2017">2017</option>
            <option style="font-family: Fira Sans" value="2016">2016</option>
            <option style="font-family: Fira Sans" value="2015">2015</option>
            <option style="font-family: Fira Sans" value="2014">2014</option>
            <option style="font-family: Fira Sans" value="2013">2013</option>
            <option style="font-family: Fira Sans" value="2012">2012</option>
            <option style="font-family: Fira Sans" value="2011">2011</option>
            <option style="font-family: Fira Sans" value="2010">2010</option>
          </select>
          {% elsif id_map == '1-d-3' %}
          <select id="yearBox" onchange="wyborYear()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
            <option style="font-family: Fira Sans" value="2023" selected>2023</option>
            <option style="font-family: Fira Sans" value="2022">2022</option>
            <option style="font-family: Fira Sans" value="2021">2021</option>
            <option style="font-family: Fira Sans" value="2020">2020</option>
            <option style="font-family: Fira Sans" value="2019">2019</option>
            <option style="font-family: Fira Sans" value="2018">2018</option>
            <option style="font-family: Fira Sans" value="2017">2017</option>
            <option style="font-family: Fira Sans" value="2016">2016</option>
            <option style="font-family: Fira Sans" value="2015">2015</option>
            <option style="font-family: Fira Sans" value="2014">2014</option>
            <option style="font-family: Fira Sans" value="2013">2013</option>
          </select>
          {% elsif id_map == '1-e-1' %}
          <select id="yearBox" onchange="wyborYear()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
            <option style="font-family: Fira Sans" value="2022" selected>2022</option>
            <option style="font-family: Fira Sans" value="2020">2020</option>
            <option style="font-family: Fira Sans" value="2018">2018</option>
            <option style="font-family: Fira Sans" value="2016">2016</option>
            <option style="font-family: Fira Sans" value="2014">2014</option>
            <option style="font-family: Fira Sans" value="2012">2012</option>
            <option style="font-family: Fira Sans" value="2010">2010</option>
          </select>
          {% elsif id_map == '1-f-2' %}
          <select id="yearBox" onchange="wyborYear()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
            <option style="font-family: Fira Sans" value="2023" selected>2023</option>
            <option style="font-family: Fira Sans" value="2022">2022</option>
            <option style="font-family: Fira Sans" value="2021">2021</option>
            <option style="font-family: Fira Sans" value="2020">2020</option>
            <option style="font-family: Fira Sans" value="2019">2019</option>
            <option style="font-family: Fira Sans" value="2018">2018</option>
            <option style="font-family: Fira Sans" value="2017">2017</option>
            <option style="font-family: Fira Sans" value="2016">2016</option>
            <option style="font-family: Fira Sans" value="2015">2015</option>
            <option style="font-family: Fira Sans" value="2014">2014</option>
            <option style="font-family: Fira Sans" value="2013">2013</option>
            <option style="font-family: Fira Sans" value="2012">2012</option>
          </select>
          {% elsif id_map == '1-g-3' %}
          <select id="yearBox" onchange="wyborYear()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
            <option style="font-family: Fira Sans" value="2022" selected>2022</option>
            <option style="font-family: Fira Sans" value="2020">2020</option>
            <option style="font-family: Fira Sans" value="2018">2018</option>
            <option style="font-family: Fira Sans" value="2016">2016</option>
            <option style="font-family: Fira Sans" value="2015">2015</option>
            <option style="font-family: Fira Sans" value="2013">2013</option>
          </select>
          {% elsif id_map == '1-g-4' %}
          <select id="yearBox" onchange="wyborYear()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
            <option style="font-family: Fira Sans" value="2023" selected>2023</option>
            <option style="font-family: Fira Sans" value="2022">2022</option>
          </select>
          {% elsif id_map == '1-g-5' %}
          <select id="yearBox" onchange="wyborYear()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
            <option style="font-family: Fira Sans" value="2022" selected>2022</option>
            <option style="font-family: Fira Sans" value="2020">2020</option>
            <option style="font-family: Fira Sans" value="2018">2018</option>
            <option style="font-family: Fira Sans" value="2016">2016</option>
            <option style="font-family: Fira Sans" value="2015">2015</option>
            <option style="font-family: Fira Sans" value="2013">2013</option>
          </select>
          {% elsif id_map == '1-g-6' %}
          <select id="yearBox" onchange="wyborYear()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
            <option style="font-family: Fira Sans" value="2022" selected>2022</option>
            <option style="font-family: Fira Sans" value="2020">2020</option>
            <option style="font-family: Fira Sans" value="2018">2018</option>
            <option style="font-family: Fira Sans" value="2016">2016</option>
            <option style="font-family: Fira Sans" value="2015">2015</option>
            <option style="font-family: Fira Sans" value="2013">2013</option>
          </select>
          {% elsif id_map == '1-g-7' %}
          <select id="yearBox" onchange="wyborYear()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
            <option style="font-family: Fira Sans" value="2023" selected>2023</option>
            <option style="font-family: Fira Sans" value="2022">2022</option>
            <option style="font-family: Fira Sans" value="2021">2021</option>
            <option style="font-family: Fira Sans" value="2020">2020</option>
            <option style="font-family: Fira Sans" value="2019">2019</option>
          </select>
          {% else %}
          <select id="yearBox" onchange="wyborYear()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
            <option style="font-family: Fira Sans" value="2023" selected>2023</option>
            <option style="font-family: Fira Sans" value="2022">2022</option>
            <option style="font-family: Fira Sans" value="2021">2021</option>
            <option style="font-family: Fira Sans" value="2020">2020</option>
            <option style="font-family: Fira Sans" value="2019">2019</option>
            <option style="font-family: Fira Sans" value="2018">2018</option>
            <option style="font-family: Fira Sans" value="2017">2017</option>
            <option style="font-family: Fira Sans" value="2016">2016</option>
            <option style="font-family: Fira Sans" value="2015">2015</option>
            <option style="font-family: Fira Sans" value="2014">2014</option>
            <option style="font-family: Fira Sans" value="2013">2013</option>
            <option style="font-family: Fira Sans" value="2012">2012</option>
            <option style="font-family: Fira Sans" value="2011">2011</option>
            <option style="font-family: Fira Sans" value="2010">2010</option>
          </select>
          {% endif %}
      </div>

      <div style="width: 75%; margin: auto; margin-top: 10px; display: inline-block; vertical-align: top;">
        <p id="wartoscPolska" style="margin: 0 auto; text-align: center;">
          {% if language == 'pl' %}
            Wczytywanie danych...
          {% else %}
            Loading data...
          {% endif %}
        </p>
      </div>

      <div class="grid-container" style="width: 75%; margin: auto; display: inline-block; margin-left: 16%;">
        <div id = "map1" class="grid-child">
          <div id="mapdiv" style="width: 100%;height: 400px">
            <div id="mapWoj" style="width: 100%;height: 400px"></div>
          </div>
        </div>
      </div>

      <hr>

  <script>

  function processData(data_processed) {
  //console.log("Dane gotowe:", data_processed);
  // użyj data gdzie chcesz
  createMapWoj("mapWoj", data_processed, "{{ language }}", {{ precyzja }});
  }

  function loadDataAndRenderMap(rok) {
  am5.ready(function() {

  am5.net.load("{{ site.baseurl }}/data/regionalne/indicator_{{ id_map }}-map.csv").then(function(result) {

    // Parse data
    var data = am5.CSVParser.parse(result.response, {
      delimiter: ",",
      reverse: true,
      skipEmpty: true,
      useColumnNames: true
    });

    // Zamiana pustych wartości na null
    data.forEach(function(item) {
      // Przejdź po wszystkich polach obiektu
      Object.keys(item).forEach(function(key) {
        if (item[key] === "" || item[key] === undefined) {
          item[key] = NaN;
        }
      });
    });

    var data_filtered = data
      .filter(item => item.REGION !== "POLSKA")  // usuwa wpis dla całej Polski
      .map(item => {

    let newName;

    switch (item.REGION) {
      case "DOLNOŚLĄSKIE":
        newName = "PL-02";
        break;
      case "KUJAWSKO-POMORSKIE":
        newName = "PL-04";
        break;
      case "LUBELSKIE":
        newName = "PL-06";
        break;
      case "LUBUSKIE":
        newName = "PL-08";
        break;
      case "ŁÓDZKIE":
        newName = "PL-10";
        break;
      case "MAŁOPOLSKIE":
        newName = "PL-12";
        break;
      case "MAZOWIECKIE":
        newName = "PL-14";
        break;
      case "OPOLSKIE":
        newName = "PL-16";
        break;
      case "PODKARPACKIE":
        newName = "PL-18";
        break;
      case "PODLASKIE":
        newName = "PL-20";
        break;
      case "POMORSKIE":
        newName = "PL-22";
        break;
      case "ŚLĄSKIE":
        newName = "PL-24";
        break;
      case "ŚWIĘTOKRZYSKIE":
        newName = "PL-26";
        break;
      case "WARMIŃSKO-MAZURSKIE":
        newName = "PL-28";
        break;
      case "WIELKOPOLSKIE":
        newName = "PL-30";
        break;
      case "ZACHODNIOPOMORSKIE":
        newName = "PL-32";
        break;
      default:
        newName = "PL-PL";
    }

    return {
      id: newName,
      value: Number(item[rok])
    };
  });

  //console.log("data", data);
  //console.log("data_filtered", data_filtered);

  processData(data_filtered);
  });

    //var daneWoj = [{"id":"PL-02","value":97.223785641},{"id":"PL-04","value":94.4174451195},{"id":"PL-06","value":96.3942170481},{"id":"PL-08","value":96.8237887052},{"id":"PL-10","value":96.5128258255},{"id":"PL-12","value":98.3907790671},{"id":"PL-14","value":98.012883452},{"id":"PL-16","value":99.210081905},{"id":"PL-18","value":94.2844886674},{"id":"PL-20","value":89.8130658568},{"id":"PL-22","value":94.7017846298},{"id":"PL-24","value":98.471359928},{"id":"PL-26","value":97.4958489946},{"id":"PL-28","value":92.3905090752},{"id":"PL-30","value":95.6207943758},{"id":"PL-32","value":94.3770711078},{"id":"PL-PL","value":96.1862414329}];
    //console.log("daneWoj", daneWoj);
  }); // end am5.ready()

  };

{% if id_map == '1-b-4' or id_map == '1-b-5' or id_map == '1-c-1' or id_map == '1-c-2' or id_map == '1-c-3' %}
  loadDataAndRenderMap("2024");
{% elsif id_map == '1-e-1' or id_map == '1-g-3' or id_map == '1-g-5' or id_map == '1-g-6' %}
  loadDataAndRenderMap("2022");
{% else %}
  loadDataAndRenderMap("2023");
{% endif %}

  function wyborYear() {
    var yearBox = document.getElementById("yearBox");
    var selectedYear = yearBox.options[yearBox.selectedIndex].value;
    //console.log("TESTER" + selectedYear);
    loadDataAndRenderMap(selectedYear);
    // if(selectedYear===0){
    // loadDataAndRenderMap("2023");
    // }
    // if(selectedYear===1){
    // loadDataAndRenderMap("2022");
    // }
    // if(selectedYear===2){
    // loadDataAndRenderMap("2021");
    // }
    // if(selectedYear===3){
    // loadDataAndRenderMap("2020");
    // }
    // if(selectedYear===4){
    // loadDataAndRenderMap("2019");
    // }
    // if(selectedYear===5){
    // loadDataAndRenderMap("2018");
    // }
    // if(selectedYear===6){
    // loadDataAndRenderMap("2017");
    // }
    // if(selectedYear===7){
    // loadDataAndRenderMap("2016");
    // }
    // if(selectedYear===8){
    // loadDataAndRenderMap("2015");
    // }
    // if(selectedYear===9){
    // loadDataAndRenderMap("2014");
    // }
    // if(selectedYear===10){
    // loadDataAndRenderMap("2013");
    // }
    // if(selectedYear===11){
    // loadDataAndRenderMap("2012");
    // }
    // if(selectedYear===12){
    // loadDataAndRenderMap("2011");
    // }
    // if(selectedYear===13){
    // loadDataAndRenderMap("2010");
    //}
   };

  </script>

  <script>
    // Adres do Twojego pliku CSV – zamień na właściwy
    const CSV_URL = '{{ site.baseurl }}/data/regionalne/indicator_{{ id_map }}-map.csv';

    const i18n = {
      naglowek: "{% if language == 'pl' %}Polska w{% else %}Poland in{% endif %}",
      blad: "{% if language == 'pl' %}Polska - brak danych dla {% else %}Poland - no data for {% endif %}",
      no_data: "{% if language == 'pl' %}Nie znaleziono danych dla Polski{% else %}No data for Poland{% endif %}"
    };

    // Zmienna na dane Polski
    let danePolski = {};

    // Funkcja pomocnicza – wczytuje CSV jako obiekt
    function parseCSV(csv) {
      const lines = csv.trim().split("\n");
      const headers = lines[0].split(",");
      const rows = lines.slice(1);

      return rows.map(line => {
        const values = line.split(",");
        let obj = {};
        headers.forEach((h, i) => obj[h.trim()] = values[i]?.trim());
        return obj;
      });
    }

    // Funkcja do aktualizacji wartości na stronie
    function updateWartosc(rok) {
      const wartosc = danePolski[rok];
      const paragraf = document.getElementById("wartoscPolska");
      if (wartosc) {
        const locale = "{% if language == 'pl' %}pl-PL{% else %}en-US{% endif %}";
        const czesci = wartosc.split('.');
        const miejscaPoPrzecinku = czesci.length === 2 ? czesci[1].length : 0;
        const wartoscLiczbowa = Number(wartosc);
        const wartoscSformatowana = wartoscLiczbowa.toLocaleString(locale, {
          minimumFractionDigits: miejscaPoPrzecinku,
          maximumFractionDigits: miejscaPoPrzecinku
          });
        paragraf.textContent = `${i18n.naglowek} ${rok}: ${wartoscSformatowana} [{% if language == 'pl' %}{{ t1.pl_jednostka_prezentacji }}{% else %}{{ t1.en_jednostka_prezentacji }}{% endif %}]`;
      } else {
        paragraf.textContent = `${i18n.blad} ${rok} {% if language == 'pl' %}roku{% else %}{% endif %} [{% if language == 'pl' %}{{ t1.pl_jednostka_prezentacji }}{% else %}{{ t1.en_jednostka_prezentacji }}{% endif %}]`;
      }
    }

    // Główne ładowanie
    fetch(CSV_URL)
      .then(response => response.text())
      .then(csvText => {
        const data = parseCSV(csvText);
        const polska = data.find(row => row.REGION?.toUpperCase() === "POLSKA");

        if (polska) {
          danePolski = polska;
          const domyslnyRok = document.getElementById("yearBox").value;
          updateWartosc(domyslnyRok);
        } else {
          document.getElementById("wartoscPolska").textContent = `${i18n.no_data}`;
        }
      });

    // Obsługa zmiany selecta
    document.getElementById("yearBox").addEventListener("change", function() {
      updateWartosc(this.value);
    });
  </script>

<!-----------------------------------------------------STARA WERSJA WYKRESU---------------------------------------------------------------------->
    <!--  {% if licznik>1 %}
        {% if language == 'pl' %}
          <div id="filtry">.</div>
          {% if id != '12-2-2' and id != '1-5-4' and id != '11-b-2' and id != '13-1-3' and id != '8-4-2' and id != '17-13-1' and id != '12-4-2'%}
          <div id="przycisk" style="width: 25%;float: right;">
            <button type="button" onclick="Zaznacz()" style="min-width: 178px;width: 80%;height: 50px;margin-bottom: 5px;float: right;" title="Pokaż wszystkie wymiary na wykresie">Zaznacz wszystko</button>
            <button type="button" onclick="Usun()" style="min-width: 178px;width: 80%;height: 50%;margin-top: 0px;float: right;" title="Wyszyść wykres do stanu początkowego">Usuń zaznaczenia</button></div>
          {% endif %}
          <div>{% include {{graph_template}} row1=row1 licznik=licznik legenda=header_csv labels=labels content2=language%}</div>
          <div id="Legenda" align="center" style="pointer-events: none;"></div>
        {% else %}
          <div id="filtry">.</div>
          {% if id != '12-2-2' and id != '1-5-4' and id != '11-b-2' and id != '13-1-3' and id != '8-4-2' and id != '17-13-1' and id != '12-4-2'%}
          <div id="przycisk" style="width: 25%;float: right;">
            <button type="button" onclick="Zaznacz()" style="min-width: 178px;width: 80%;height: 50px;margin-bottom: 5px;float: right;" title="Show all dimensions on chart">Select All</button>
            <button type="button" onclick="Usun()" style="min-width: 178px;width: 80%;height: 50%;margin-top: 0px;float: right;" title="Clear the chart">Clear All</button></div>
          {% endif %}
          <br>
          <div>{% include {{graph_template}} row1=row1 licznik=licznik legenda=header_csv labels=labels content2=language%}</div>
          <div id="Legenda" align="center" style="pointer-events: none;"></div>
        {% endif %}
        <div>{% include components/filters_reg.html content=filtry content1=foo content2=language%}</div>
      {%else%}
        <div>{% include {{graph_template}} row1=row1 licznik=licznik legenda=header_csv labels=labels content2=language%}</div>
        <div id="Legenda" align="center" style="pointer-events: none;"></div>
      {% endif %}
-->
<!-----------------------------------------------------NOWA WERSJA WYKRESU - AMCHART---------------------------------------------------------------------->
    <div style="width: 100%; position: relative;">
      {% if id_map == '1-a-4' %}
      <select id="yearBoxBar" onchange="updateChartBar()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
        <option style="font-family: Fira Sans" value="2023" selected>2023</option>
        <option style="font-family: Fira Sans" value="2022">2022</option>
        <option style="font-family: Fira Sans" value="2021">2021</option>
        <option style="font-family: Fira Sans" value="2020">2020</option>
        <option style="font-family: Fira Sans" value="2019">2019</option>
        <option style="font-family: Fira Sans" value="2018">2018</option>
        <option style="font-family: Fira Sans" value="2017">2017</option>
        <option style="font-family: Fira Sans" value="2016">2016</option>
        <option style="font-family: Fira Sans" value="2015">2015</option>
      </select>
      {% elsif id_map == '1-b-2' %}
      <select id="yearBoxBar" onchange="updateChartBar()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
        <option style="font-family: Fira Sans" value="2023" selected>2023</option>
        <option style="font-family: Fira Sans" value="2022">2022</option>
      </select>
      {% elsif id_map == '1-b-4' %}
      <select id="yearBoxBar" onchange="updateChartBar()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
        <option style="font-family: Fira Sans" value="2024" selected>2024</option>
        <option style="font-family: Fira Sans" value="2023">2023</option>
        <option style="font-family: Fira Sans" value="2022">2022</option>
        <option style="font-family: Fira Sans" value="2021">2021</option>
        <option style="font-family: Fira Sans" value="2020">2020</option>
        <option style="font-family: Fira Sans" value="2019">2019</option>
        <option style="font-family: Fira Sans" value="2018">2018</option>
        <option style="font-family: Fira Sans" value="2017">2017</option>
        <option style="font-family: Fira Sans" value="2016">2016</option>
        <option style="font-family: Fira Sans" value="2015">2015</option>
        <option style="font-family: Fira Sans" value="2014">2014</option>
        <option style="font-family: Fira Sans" value="2013">2013</option>
        <option style="font-family: Fira Sans" value="2012">2012</option>
        <option style="font-family: Fira Sans" value="2011">2011</option>
      </select>
      {% elsif id_map == '1-b-5' %}
      <select id="yearBoxBar" onchange="updateChartBar()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
        <option style="font-family: Fira Sans" value="2024" selected>2024</option>
        <option style="font-family: Fira Sans" value="2023">2023</option>
        <option style="font-family: Fira Sans" value="2022">2022</option>
        <option style="font-family: Fira Sans" value="2021">2021</option>
        <option style="font-family: Fira Sans" value="2020">2020</option>
        <option style="font-family: Fira Sans" value="2019">2019</option>
        <option style="font-family: Fira Sans" value="2018">2018</option>
        <option style="font-family: Fira Sans" value="2017">2017</option>
        <option style="font-family: Fira Sans" value="2016">2016</option>
        <option style="font-family: Fira Sans" value="2015">2015</option>
        <option style="font-family: Fira Sans" value="2014">2014</option>
        <option style="font-family: Fira Sans" value="2013">2013</option>
        <option style="font-family: Fira Sans" value="2012">2012</option>
        <option style="font-family: Fira Sans" value="2011">2011</option>
        <option style="font-family: Fira Sans" value="2010">2010</option>
      </select>
      {% elsif id_map == '1-b-7' %}
      <select id="yearBoxBar" onchange="updateChartBar()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
        <option style="font-family: Fira Sans" value="2023" selected>2023</option>
        <option style="font-family: Fira Sans" value="2022">2022</option>
        <option style="font-family: Fira Sans" value="2021">2021</option>
        <option style="font-family: Fira Sans" value="2020">2020</option>
        <option style="font-family: Fira Sans" value="2019">2019</option>
        <option style="font-family: Fira Sans" value="2018">2018</option>
        <option style="font-family: Fira Sans" value="2017">2017</option>
        <option style="font-family: Fira Sans" value="2016">2016</option>
      </select>
      {% elsif id_map == '1-b-8' %}
      <select id="yearBoxBar" onchange="updateChartBar()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
        <option style="font-family: Fira Sans" value="2023" selected>2023</option>
        <option style="font-family: Fira Sans" value="2022">2022</option>
        <option style="font-family: Fira Sans" value="2021">2021</option>
        <option style="font-family: Fira Sans" value="2020">2020</option>
        <option style="font-family: Fira Sans" value="2019">2019</option>
        <option style="font-family: Fira Sans" value="2018">2018</option>
        <option style="font-family: Fira Sans" value="2017">2017</option>
      </select>
      {% elsif id_map == '1-c-1' %}
      <select id="yearBoxBar" onchange="updateChartBar()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
        <option style="font-family: Fira Sans" value="2024" selected>2024</option>
        <option style="font-family: Fira Sans" value="2023">2023</option>
        <option style="font-family: Fira Sans" value="2022">2022</option>
        <option style="font-family: Fira Sans" value="2021">2021</option>
        <option style="font-family: Fira Sans" value="2020">2020</option>
        <option style="font-family: Fira Sans" value="2019">2019</option>
        <option style="font-family: Fira Sans" value="2018">2018</option>
        <option style="font-family: Fira Sans" value="2017">2017</option>
        <option style="font-family: Fira Sans" value="2016">2016</option>
        <option style="font-family: Fira Sans" value="2015">2015</option>
        <option style="font-family: Fira Sans" value="2014">2014</option>
        <option style="font-family: Fira Sans" value="2013">2013</option>
        <option style="font-family: Fira Sans" value="2012">2012</option>
        <option style="font-family: Fira Sans" value="2011">2011</option>
        <option style="font-family: Fira Sans" value="2010">2010</option>
      </select>
      {% elsif id_map == '1-c-2' %}
      <select id="yearBoxBar" onchange="updateChartBar()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
        <option style="font-family: Fira Sans" value="2024" selected>2024</option>
        <option style="font-family: Fira Sans" value="2023">2023</option>
        <option style="font-family: Fira Sans" value="2022">2022</option>
        <option style="font-family: Fira Sans" value="2021">2021</option>
        <option style="font-family: Fira Sans" value="2020">2020</option>
        <option style="font-family: Fira Sans" value="2019">2019</option>
        <option style="font-family: Fira Sans" value="2018">2018</option>
        <option style="font-family: Fira Sans" value="2017">2017</option>
        <option style="font-family: Fira Sans" value="2016">2016</option>
        <option style="font-family: Fira Sans" value="2015">2015</option>
        <option style="font-family: Fira Sans" value="2014">2014</option>
        <option style="font-family: Fira Sans" value="2013">2013</option>
        <option style="font-family: Fira Sans" value="2012">2012</option>
        <option style="font-family: Fira Sans" value="2011">2011</option>
        <option style="font-family: Fira Sans" value="2010">2010</option>
      </select>
      {% elsif id_map == '1-c-3' %}
      <select id="yearBoxBar" onchange="updateChartBar()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
        <option style="font-family: Fira Sans" value="2024" selected>2024</option>
        <option style="font-family: Fira Sans" value="2023">2023</option>
        <option style="font-family: Fira Sans" value="2022">2022</option>
        <option style="font-family: Fira Sans" value="2021">2021</option>
        <option style="font-family: Fira Sans" value="2020">2020</option>
        <option style="font-family: Fira Sans" value="2019">2019</option>
        <option style="font-family: Fira Sans" value="2018">2018</option>
        <option style="font-family: Fira Sans" value="2017">2017</option>
        <option style="font-family: Fira Sans" value="2016">2016</option>
        <option style="font-family: Fira Sans" value="2015">2015</option>
        <option style="font-family: Fira Sans" value="2014">2014</option>
        <option style="font-family: Fira Sans" value="2013">2013</option>
        <option style="font-family: Fira Sans" value="2012">2012</option>
        <option style="font-family: Fira Sans" value="2011">2011</option>
        <option style="font-family: Fira Sans" value="2010">2010</option>
      </select>
      {% elsif id_map == '1-d-3' %}
      <select id="yearBoxBar" onchange="updateChartBar()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
        <option style="font-family: Fira Sans" value="2023" selected>2023</option>
        <option style="font-family: Fira Sans" value="2022">2022</option>
        <option style="font-family: Fira Sans" value="2021">2021</option>
        <option style="font-family: Fira Sans" value="2020">2020</option>
        <option style="font-family: Fira Sans" value="2019">2019</option>
        <option style="font-family: Fira Sans" value="2018">2018</option>
        <option style="font-family: Fira Sans" value="2017">2017</option>
        <option style="font-family: Fira Sans" value="2016">2016</option>
        <option style="font-family: Fira Sans" value="2015">2015</option>
        <option style="font-family: Fira Sans" value="2014">2014</option>
        <option style="font-family: Fira Sans" value="2013">2013</option>
      </select>
      {% elsif id_map == '1-e-1' %}
      <select id="yearBoxBar" onchange="updateChartBar()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
        <option style="font-family: Fira Sans" value="2022" selected>2022</option>
        <option style="font-family: Fira Sans" value="2020">2020</option>
        <option style="font-family: Fira Sans" value="2018">2018</option>
        <option style="font-family: Fira Sans" value="2016">2016</option>
        <option style="font-family: Fira Sans" value="2014">2014</option>
        <option style="font-family: Fira Sans" value="2012">2012</option>
        <option style="font-family: Fira Sans" value="2010">2010</option>
      </select>
      {% elsif id_map == '1-f-2' %}
      <select id="yearBoxBar" onchange="updateChartBar()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
        <option style="font-family: Fira Sans" value="2023" selected>2023</option>
        <option style="font-family: Fira Sans" value="2022">2022</option>
        <option style="font-family: Fira Sans" value="2021">2021</option>
        <option style="font-family: Fira Sans" value="2020">2020</option>
        <option style="font-family: Fira Sans" value="2019">2019</option>
        <option style="font-family: Fira Sans" value="2018">2018</option>
        <option style="font-family: Fira Sans" value="2017">2017</option>
        <option style="font-family: Fira Sans" value="2016">2016</option>
        <option style="font-family: Fira Sans" value="2015">2015</option>
        <option style="font-family: Fira Sans" value="2014">2014</option>
        <option style="font-family: Fira Sans" value="2013">2013</option>
        <option style="font-family: Fira Sans" value="2012">2012</option>
      </select>
      {% elsif id_map == '1-g-3' %}
      <select id="yearBoxBar" onchange="updateChartBar()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
        <option style="font-family: Fira Sans" value="2022" selected>2022</option>
        <option style="font-family: Fira Sans" value="2020">2020</option>
        <option style="font-family: Fira Sans" value="2018">2018</option>
        <option style="font-family: Fira Sans" value="2016">2016</option>
        <option style="font-family: Fira Sans" value="2015">2015</option>
        <option style="font-family: Fira Sans" value="2013">2013</option>
      </select>
      {% elsif id_map == '1-g-4' %}
      <select id="yearBoxBar" onchange="updateChartBar()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
        <option style="font-family: Fira Sans" value="2023" selected>2023</option>
        <option style="font-family: Fira Sans" value="2022">2022</option>
      </select>
      {% elsif id_map == '1-g-5' %}
      <select id="yearBoxBar" onchange="updateChartBar()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
        <option style="font-family: Fira Sans" value="2022" selected>2022</option>
        <option style="font-family: Fira Sans" value="2020">2020</option>
        <option style="font-family: Fira Sans" value="2018">2018</option>
        <option style="font-family: Fira Sans" value="2016">2016</option>
        <option style="font-family: Fira Sans" value="2015">2015</option>
        <option style="font-family: Fira Sans" value="2013">2013</option>
      </select>
      {% elsif id_map == '1-g-6' %}
      <select id="yearBoxBar" onchange="updateChartBar()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
        <option style="font-family: Fira Sans" value="2022" selected>2022</option>
        <option style="font-family: Fira Sans" value="2020">2020</option>
        <option style="font-family: Fira Sans" value="2018">2018</option>
        <option style="font-family: Fira Sans" value="2016">2016</option>
        <option style="font-family: Fira Sans" value="2015">2015</option>
        <option style="font-family: Fira Sans" value="2013">2013</option>
      </select>
      {% elsif id_map == '1-g-7' %}
      <select id="yearBoxBar" onchange="updateChartBar()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
        <option style="font-family: Fira Sans" value="2023" selected>2023</option>
        <option style="font-family: Fira Sans" value="2022">2022</option>
        <option style="font-family: Fira Sans" value="2021">2021</option>
        <option style="font-family: Fira Sans" value="2020">2020</option>
        <option style="font-family: Fira Sans" value="2019">2019</option>
      </select>
      {% else %}
      <select id="yearBoxBar" onchange="updateChartBar()" name="year-name" style="padding: 5px; max-width: 150px; display: inline; height: 35px; color: rgb(51,51,51);font-size: 14px;">
        <option style="font-family: Fira Sans" value="2023" selected>2023</option>
        <option style="font-family: Fira Sans" value="2022">2022</option>
        <option style="font-family: Fira Sans" value="2021">2021</option>
        <option style="font-family: Fira Sans" value="2020">2020</option>
        <option style="font-family: Fira Sans" value="2019">2019</option>
        <option style="font-family: Fira Sans" value="2018">2018</option>
        <option style="font-family: Fira Sans" value="2017">2017</option>
        <option style="font-family: Fira Sans" value="2016">2016</option>
        <option style="font-family: Fira Sans" value="2015">2015</option>
        <option style="font-family: Fira Sans" value="2014">2014</option>
        <option style="font-family: Fira Sans" value="2013">2013</option>
        <option style="font-family: Fira Sans" value="2012">2012</option>
        <option style="font-family: Fira Sans" value="2011">2011</option>
        <option style="font-family: Fira Sans" value="2010">2010</option>
      </select>
      {% endif %}



      <style>
        details {
          font-size: 14px;
          border: 1px solid #5b616b;
          display: inline-flex;
          flex-direction: column;
          padding: 5px;
          padding-top: 0px;
          width: 250px;
          min-height: 35px;
          margin: 0.2em 0;
          position: absolute;
          top: 0;
          left: 155px;
          z-index: 10;
          background: #fff;
        }

        details summary{
          top: 5px;
          position: relative;
        }

        details summary::marker {
          display: none;
          font-size: 0;
        }

        details summary::-webkit-details-marker {
          display: none;
          font-size: 0;
        }

        details summary::after {
          content: url("../../assets/img/arrow-down.svg");
          content: url("../../../assets/img/arrow-down.svg");
          display: inline-block;
          font-size: 0.6rem;
          height: 1rem;
          line-height: 1rem;
          margin-left: 12.5rem;
          transition: transform 0.25s;
          width: 22px;
          position: absolute;
          transition: transform 0.25s;
        }

        details[open] summary {
          margin-bottom: 1rem;
        }

        fieldset {
          border: 0;
          padding: 0;
        }

        fieldset legend {
          position: absolute !important;
          width: 1px !important;
          height: 1px !important;
          padding: 0 !important;
          margin: -1px !important;
          overflow: hidden !important;
          clip: rect(0, 0, 0, 0) !important;
          white-space: nowrap !important;
          border: 0 !important;
        }

        #chooseWojLine ul li {
          border-radius: 3px;
          margin: 0;
          padding: 4px 2px;
        }

        #chooseWojLine ul li:hover {
          background: #eee;
        }

        #chooseWojLine ul li::after
        {
          margin-bottom: 0 !important;
        }
        #chooseWojLine ul li label {
          display: inline-block;
          font-weight: 400;
        }

        #chooseWojBar ul li {
          border-radius: 3px;
          margin: 0;
          padding: 4px 2px;
          font-size: 14px;
        }

        #chooseWojBar ul li:hover {
          background: #eee;
        }

        #chooseWojBar ul li::after
        {
          margin-bottom: 0 !important;
        }
        #chooseWojBar ul li label {
          display: inline-block;
          font-weight: 400;
          font-size: 14px;
        }
      </style>

      <div id="chooseWojBar" style="display: inline-flex;margin-right: 1rem;">

      {% if language == 'pl' %}
        <details id="myselectlistBsr">
          <summary>Województwo</summary>
          <form style="float: left;">
            <fieldset>
              <ul style="list-style: none; margin: 0; padding: 0;">
                <li>
                  <label style="margin-top:0;color: #777;" for="all">Zaznacz/Usuń wszystko</label>
                  <input type="checkbox" id="all" name="all" value="all" onchange="addAllBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block; height:15px;width:15px;"/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Polska">Polska</label>
                  <input type="checkbox" id="Polska" name="Polska" value="Polska" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block; height:15px;width:15px;"/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Dolnośląskie">Dolnośląskie</label>
                  <input type="checkbox" id="Dolnośląskie" name="Dolnośląskie" value="Dolnośląskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked="true" />
                </li>
                <li>
                  <label style="margin-top:0;" for="Kujawsko-Pomorskie">Kujawsko-Pomorskie</label>
                  <input type="checkbox" id="Kujawsko-Pomorskie" name="Kujawsko-Pomorskie" value="Kujawsko-Pomorskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Lubelskie">Lubelskie</label>
                  <input type="checkbox" id="Lubelskie" name="Lubelskie" value="Lubelskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Lubuskie">Lubuskie</label>
                  <input type="checkbox" id="Lubuskie" name="Lubuskie" value="Lubuskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Łódzkie">Łódzkie</label>
                  <input type="checkbox" id="Łódzkie" name="Łódzkie" value="Łódzkie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Małopolskie">Małopolskie</label>
                  <input type="checkbox" id="Małopolskie" name="Małopolskie" value="Małopolskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Mazowieckie">Mazowieckie</label>
                  <input type="checkbox" id="Mazowieckie" name="Mazowieckie" value="Mazowieckie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Opolskie">Opolskie</label>
                  <input type="checkbox" id="Opolskie" name="Opolskie" value="Opolskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Podkarpackie">Podkarpackie</label>
                  <input type="checkbox" id="Podkarpackie" name="Podkarpackie" value="Podkarpackie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Kujawsko-Pomorskie">Podlaskie</label>
                  <input type="checkbox" id="Podlaskie" name="Podlaskie" value="Podlaskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Pomorskie">Pomorskie</label>
                  <input type="checkbox" id="Pomorskie" name="Pomorskie" value="Pomorskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Śląskie">Śląskie</label>
                  <input type="checkbox" id="Śląskie" name="Śląskie" value="Śląskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Świętokrzyskie">Świętokrzyskie</label>
                  <input type="checkbox" id="Świętokrzyskie" name="Świętokrzyskie" value="Świętokrzyskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Warmińsko-Mazurskie">Warmińsko-Mazurskie</label>
                  <input type="checkbox" id="Warmińsko-Mazurskie" name="Warmińsko-Mazurskie" value="Warmińsko-Mazurskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Wielkopolskie">Wielkopolskie</label>
                  <input type="checkbox" id="Wielkopolskie" name="Wielkopolskie" value="Wielkopolskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Zachodniopomorskie">Zachodniopomorskie</label>
                  <input type="checkbox" id="Zachodniopomorskie" name="Zachodniopomorskie" value="Zachodniopomorskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
              </ul>
            </fieldset>
          </form>

        </details>
      {% else %}
        <details id="myselectlistBsr">
          <summary>Voivodeship</summary>
          <form style="float: left;">
            <fieldset>
              <ul style="list-style: none; margin: 0; padding: 0;">
                <li>
                  <label style="margin-top:0;color: #777;" for="all">Select/Diselect all</label>
                  <input type="checkbox" id="all" name="all" value="all" onchange="addAllBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block; height:15px;width:15px;"/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Polska">Poland</label>
                  <input type="checkbox" id="Polska" name="Polska" value="Polska" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block; height:15px;width:15px;"/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Dolnośląskie">Dolnośląskie</label>
                  <input type="checkbox" id="Dolnośląskie" name="Dolnośląskie" value="Dolnośląskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked="true" />
                </li>
                <li>
                  <label style="margin-top:0;" for="Kujawsko-Pomorskie">Kujawsko-Pomorskie</label>
                  <input type="checkbox" id="Kujawsko-Pomorskie" name="Kujawsko-Pomorskie" value="Kujawsko-Pomorskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Lubelskie">Lubelskie</label>
                  <input type="checkbox" id="Lubelskie" name="Lubelskie" value="Lubelskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Lubuskie">Lubuskie</label>
                  <input type="checkbox" id="Lubuskie" name="Lubuskie" value="Lubuskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Łódzkie">Łódzkie</label>
                  <input type="checkbox" id="Łódzkie" name="Łódzkie" value="Łódzkie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Małopolskie">Małopolskie</label>
                  <input type="checkbox" id="Małopolskie" name="Małopolskie" value="Małopolskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Mazowieckie">Mazowieckie</label>
                  <input type="checkbox" id="Mazowieckie" name="Mazowieckie" value="Mazowieckie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Opolskie">Opolskie</label>
                  <input type="checkbox" id="Opolskie" name="Opolskie" value="Opolskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Podkarpackie">Podkarpackie</label>
                  <input type="checkbox" id="Podkarpackie" name="Podkarpackie" value="Podkarpackie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Kujawsko-Pomorskie">Podlaskie</label>
                  <input type="checkbox" id="Podlaskie" name="Podlaskie" value="Podlaskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Pomorskie">Pomorskie</label>
                  <input type="checkbox" id="Pomorskie" name="Pomorskie" value="Pomorskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Śląskie">Śląskie</label>
                  <input type="checkbox" id="Śląskie" name="Śląskie" value="Śląskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Świętokrzyskie">Świętokrzyskie</label>
                  <input type="checkbox" id="Świętokrzyskie" name="Świętokrzyskie" value="Świętokrzyskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Warmińsko-Mazurskie">Warmińsko-Mazurskie</label>
                  <input type="checkbox" id="Warmińsko-Mazurskie" name="Warmińsko-Mazurskie" value="Warmińsko-Mazurskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Wielkopolskie">Wielkopolskie</label>
                  <input type="checkbox" id="Wielkopolskie" name="Wielkopolskie" value="Wielkopolskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Zachodniopomorskie">Zachodniopomorskie</label>
                  <input type="checkbox" id="Zachodniopomorskie" name="Zachodniopomorskie" value="Zachodniopomorskie" onchange="updateChartBar()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
              </ul>
            </fieldset>
          </form>

        </details>
      {% endif %}
      </div>
    </div>

      <div id="chartBar" style="width: 100%;height: 600px"></div>
      <hr>


      <div id="chooseWojLine" style="display: inline-flex;margin-right: 1rem; position: relative;">
      {% if language == 'pl' %}
        <details id="myselectlistLine" style="top: -20px; left: 0;">
          <summary>Województwo</summary>
          <form style="float: left;">
            <fieldset>
              <ul style="list-style: none; margin: 0; padding: 0;">
                <li>
                  <label style="margin-top:0;color: #777;" for="all">Zaznacz/Usuń wszystko</label>
                  <input type="checkbox" id="all" name="all" value="all" onchange="addAllLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block; height:15px;width:15px;"/>
                </li>
                <li>
                  <label style="margin-top:0;" for="PolskaLineCheckbox">Polska</label>
                  <input type="checkbox" id="PolskaLineCheckbox" name="PolskaLine" value="Polska" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block; height:15px;width:15px;"/>
                </li>
                <li>
                  <label style="margin-top:0;" for="DolnośląskieLineCheckbox">Dolnośląskie</label>
                  <input type="checkbox" id="DolnośląskieLineCheckbox" name="DolnośląskieLine" value="Dolnośląskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                </li>
                <li>
                  <label style="margin-top:0;" for="Kujawsko-PomorskieLineCheckbox">Kujawsko-Pomorskie</label>
                    <input type="checkbox" id="Kujawsko-PomorskieLineCheckbox" name="Kujawsko-PomorskieLine" value="Kujawsko-Pomorskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="LubelskieLineCheckbox">Lubelskie</label>
                    <input type="checkbox" id="LubelskieLineCheckbox" name="LubelskieLine" value="Lubelskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="LubuskieLineCheckbox">Lubuskie</label>
                    <input type="checkbox" id="LubuskieLineCheckbox" name="LubuskieLine" value="Lubuskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="ŁódzkieLineCheckbox">Łódzkie</label>
                    <input type="checkbox" id="ŁódzkieLineCheckbox" name="ŁódzkieLine" value="Łódzkie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="MałopolskieLineCheckbox">Małopolskie</label>
                    <input type="checkbox" id="MałopolskieLineCheckbox" name="MałopolskieLine" value="Małopolskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="MazowieckieLineCheckbox">Mazowieckie</label>
                    <input type="checkbox" id="MazowieckieLineCheckbox" name="MazowieckieLine" value="Mazowieckie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="OpolskieLineCheckbox">Opolskie</label>
                    <input type="checkbox" id="OpolskieLineCheckbox" name="OpolskieLine" value="Opolskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="PodkarpackieLineCheckbox">Podkarpackie</label>
                    <input type="checkbox" id="PodkarpackieLineCheckbox" name="PodkarpackieLine" value="Podkarpackie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="PodlaskieLineCheckbox">Podlaskie</label>
                    <input type="checkbox" id="PodlaskieLineCheckbox" name="PodlaskieLine" value="Podlaskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="PomorskieLineCheckbox">Pomorskie</label>
                    <input type="checkbox" id="PomorskieLineCheckbox" name="PomorskieLine" value="Pomorskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="ŚląskieLineCheckbox">Śląskie</label>
                    <input type="checkbox" id="ŚląskieLineCheckbox" name="ŚląskieLine" value="Śląskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="ŚwiętokrzyskieLineCheckbox">Świętokrzyskie</label>
                    <input type="checkbox" id="ŚwiętokrzyskieLineCheckbox" name="ŚwiętokrzyskieLine" value="Świętokrzyskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="Warmińsko-MazurskieLineCheckbox">Warmińsko-Mazurskie</label>
                    <input type="checkbox" id="Warmińsko-MazurskieLineCheckbox" name="Warmińsko-MazurskieLine" value="Warmińsko-Mazurskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="WielkopolskieLineCheckbox">Wielkopolskie</label>
                    <input type="checkbox" id="WielkopolskieLineCheckbox" name="WielkopolskieLine" value="Wielkopolskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="ZachodniopomorskieLineCheckbox">Zachodniopomorskie</label>
                    <input type="checkbox" id="ZachodniopomorskieLineCheckbox" name="ZachodniopomorskieLine" value="Zachodniopomorskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                </ul>
              </fieldset>
            </form>

          </details>

        {% else %}
          <details id="myselectlistLine" style="top: -20px; left: 0;">
            <summary>Voivodeship</summary>
            <form style="float: left;">
              <fieldset>
                <ul style="list-style: none; margin: 0; padding: 0;">
                  <li>
                    <label style="margin-top:0;color: #777;" for="all">Select/Diselect all</label>
                    <input type="checkbox" id="all" name="all" value="all" onchange="addAllLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block; height:15px;width:15px;"/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="PolskaLineCheckbox">Poland</label>
                    <input type="checkbox" id="PolskaLineCheckbox" name="PolskaLine" value="Polska" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block; height:15px;width:15px;"/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="DolnośląskieLineCheckbox">Dolnośląskie</label>
                    <input type="checkbox" id="DolnośląskieLineCheckbox" name="DolnośląskieLine" value="Dolnośląskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                  <label style="margin-top:0;" for="Kujawsko-PomorskieLineCheckbox">Kujawsko-Pomorskie</label>
                    <input type="checkbox" id="Kujawsko-PomorskieLineCheckbox" name="Kujawsko-PomorskieLine" value="Kujawsko-Pomorskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="LubelskieLineCheckbox">Lubelskie</label>
                    <input type="checkbox" id="LubelskieLineCheckbox" name="LubelskieLine" value="Lubelskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="LubuskieLineCheckbox">Lubuskie</label>
                    <input type="checkbox" id="LubuskieLineCheckbox" name="LubuskieLine" value="Lubuskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="ŁódzkieLineCheckbox">Łódzkie</label>
                    <input type="checkbox" id="ŁódzkieLineCheckbox" name="ŁódzkieLine" value="Łódzkie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="MałopolskieLineCheckbox">Małopolskie</label>
                    <input type="checkbox" id="MałopolskieLineCheckbox" name="MałopolskieLine" value="Małopolskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="MazowieckieLineCheckbox">Mazowieckie</label>
                    <input type="checkbox" id="MazowieckieLineCheckbox" name="MazowieckieLine" value="Mazowieckie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="OpolskieLineCheckbox">Opolskie</label>
                    <input type="checkbox" id="OpolskieLineCheckbox" name="OpolskieLine" value="Opolskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="PodkarpackieLineCheckbox">Podkarpackie</label>
                    <input type="checkbox" id="PodkarpackieLineCheckbox" name="PodkarpackieLine" value="Podkarpackie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="PodlaskieLineCheckbox">Podlaskie</label>
                    <input type="checkbox" id="PodlaskieLineCheckbox" name="PodlaskieLine" value="Podlaskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="PomorskieLineCheckbox">Pomorskie</label>
                    <input type="checkbox" id="PomorskieLineCheckbox" name="PomorskieLine" value="Pomorskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="ŚląskieLineCheckbox">Śląskie</label>
                    <input type="checkbox" id="ŚląskieLineCheckbox" name="ŚląskieLine" value="Śląskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="ŚwiętokrzyskieLineCheckbox">Świętokrzyskie</label>
                    <input type="checkbox" id="ŚwiętokrzyskieLineCheckbox" name="ŚwiętokrzyskieLine" value="Świętokrzyskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="Warmińsko-MazurskieLineCheckbox">Warmińsko-Mazurskie</label>
                    <input type="checkbox" id="Warmińsko-MazurskieLineCheckbox" name="Warmińsko-MazurskieLine" value="Warmińsko-Mazurskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="WielkopolskieLineCheckbox">Wielkopolskie</label>
                    <input type="checkbox" id="WielkopolskieLineCheckbox" name="WielkopolskieLine" value="Wielkopolskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                  <li>
                    <label style="margin-top:0;" for="ZachodniopomorskieLineCheckbox">Zachodniopomorskie</label>
                    <input type="checkbox" id="ZachodniopomorskieLineCheckbox" name="ZachodniopomorskieLine" value="Zachodniopomorskie" onchange="updateChartLine()" style="margin-left: 10px; opacity:1; -webkit-appearance:checkbox; display:inline-block;height:15px;width:15px;" checked/>
                  </li>
                </ul>
              </fieldset>
            </form>

          </details>
        {% endif %}
      </div>

      <div id="chartLine" style="width: 100%;height: 600px;margin-top: 20px;"></div>


      <hr>

      {% include {{table_template}} content=header_csv content1=sdg_indicator content2=language%}
      {% if language == 'pl' %}
        Jednostka prezentacji: {{ t1.pl_jednostka_prezentacji }} <br />
        Źródło danych: {{ t1.pl_zrodlo_danych }}
      {% endif %}
      {% if language == 'en' %}
        Unit: {{ t1.en_jednostka_prezentacji }} <br />
        Source of data: {{ t1.en_zrodlo_danych }}
      {% endif %}
      <p></p>
    {% else %}
      {% if language == 'pl' %}
        <p style="text-align: center;">W przyszłości pojawi się tu tabela</p>
      {% else %}
        <p style="text-align: center;">The table will appear here</p>
      {% endif %}
    {% endif %}

    {% if language == 'pl' %}
      {% if filtry.size>0 %}
        <button type="button" id="wybrane" onclick="Wybrane(1)" style="padding: 10px; float: right;" title="Pobierz wybrane dane w formacie .csv">Pobierz wybrane</button>
      {% endif %}
      <button type="button" id="calosc" onclick="Calosc(1)" style="padding: 10px; float: right;" title="Pobierz dane w formacie .csv">Pobierz całość</button>
    {% else %}
      {% if filtry.size>0 %}
        <button type="button" id="wybrane" onclick="Wybrane(2)" style="padding: 10px; float: right;" title="Download selected data in csv format">Download Selected</button>
      {% endif %}
      <button type="button" id="calosc" onclick="Calosc(2)" style="padding: 10px; float: right;" title="Download all data in csv format">Download All</button>
    {% endif %}
    </div>
    </div>


    <div role="tabpanel" class="tab-pane" id="metadata">
      <div class="metadata-table">
        <h2 style="display: contents;">{{ t.global-metadata }}</h2>

        {% assign indicator_decimals = page.indicator | split: '.'  %}
        {% assign goal_num = indicator_decimals[0] | plus:0  %}
        {% assign target_num = indicator_decimals[1] | plus:0  %}
        {% assign indicator_num = indicator_decimals[2] | plus:0  %}

        {% if goal_num < 10 %} {% assign goal_num = goal_num | prepend:0  %} {% endif %}
        {% if target_num < 10 %} {% assign target_num = target_num | prepend:0  %} {% endif %}
        {% if indicator_num < 10 %} {% assign indicator_num = indicator_num | prepend:0  %} {% endif %}

    {% if language == 'pl' %}
      <a href="{{ site.baseurl }}/assets/pdf/{{ page.lang }}/{{page.indicator | replace: ".", "-"}}.pdf" target="_blank">
      <button style="float: right;margin-right: 0px;"><i class="fa fa-file-pdf-o" alt="Pobierz PDF" title="Pobierz metadane w formacie PDF" style="font-size:20px;"></i></button>
      </a>
    {% else %}
      <a href="{{ site.baseurl }}/assets/pdf/en/{{page.indicator | replace: ".", "-"}}.pdf" target="_blank">
      <button style="float: right;margin-right: 0px;"><i class="fa fa-file-pdf-o" alt="Save as PDF" title="Save metadata in PDF format" style="font-size:20px;"></i></button>
      </a>
    {% endif %}




        <table id="metadane">
          {% if page.url contains '/statistics_reg/' %}
            {% for indicator_metadata in site.prose.metadata._metadane_regionalne %}
              {% if indicator_metadata.name != 'pl_graph_title' and indicator_metadata.name != 'pl_title' and indicator_metadata.name != 'pl_jednostka' and indicator_metadata.name != 'en_graph_title' and indicator_metadata.name != 'en_title' and indicator_metadata.name != 'en_jednostka'%}
                <tr>
                  {% if language == 'pl' %}
                    {% if indicator_metadata.name contains 'pl_' %}
                      <th style="padding: 5px; height: 45px;">  {{ indicator_metadata.field.label }} </th>
                      <td style="padding: 10px; text-align: left; height: 45px;">  {{ t1.[indicator_metadata.name] }} </td>
                    {% endif %}
                  {% else %}
                    {% if indicator_metadata.name contains 'en_' %}
                      <th style="padding: 5px; height: 45px;">  {{ indicator_metadata.field.label }} </th>
                      <td style="padding: 10px; text-align: left; height: 45px;">  {{ t1.[indicator_metadata.name] }} </td>
                    {% endif %}
                  {% endif %}
                </tr>
              {% endif %}
            {% endfor %}
          {% endif %}
        </table>


      </div>
    </div>


</div>



<script>
				function onChangeOption(value){
					//console.log(value);

					var wojMap = document.getElementById("mapWoj");

					if(value==="Woj"){
						wojMap.removeAttribute("hidden");
					}
				}


  $( document ).ready(function(){
    //console.log('site_met','{{site.metadane_regionalne}}');
    //console.log('site_','{{site.translations}}');
    //console.log('trans','{{translation_id}}');
    //console.log('indicator1','{{jednostka}}');


      if ('{{metadane["jednostka_prezentacji"]}}'==''){
          $('.usa-button').css('display','none');
      }

      const details = document.getElementById('myselectlistBsr');
      const details2 = document.getElementById('myselectlistLine');

      // Close when clicking outside
      document.addEventListener('click', e => {
        if (details.open && !details.contains(e.target)) {
          details.removeAttribute('open');
        }
      });
      document.addEventListener('click', e => {
        if (details2.open && !details2.contains(e.target)) {
          details2.removeAttribute('open');
        }
      });
  });

function Wybrane(jez){
  var filename='{{ page.indicator }}'
  var html = document.querySelector(".gridtable").outerHTML;
  var csv = [];
	var rows = document.querySelectorAll(".gridtable tr");
  for (var i = 0; i < rows.length; i++) {
    var row = [], cols = rows[i].querySelectorAll("td, th");

        for (var j = 0; j < cols.length; j++)
        if(rows[i].style.display != 'none'){
            row.push(cols[j].innerText);
        }
    if(rows[i].style.display != 'none'){

      if(jez==2){
        csv.push(row.join(","));
      }else{
        csv.push(row.join(";"));
      }

    }
  }
  if(jez==2){
    var reszta='selected';
  }else{
    var reszta='wybrane';
  }
  download_csv(csv.join("\n"), filename+'_'+reszta+'.csv');
}

function Calosc(jez){
  var filename='{{ page.indicator }}'
  var html = document.querySelector(".gridtable").outerHTML;
  var csv = [];
	var rows = document.querySelectorAll(".gridtable tr");
  for (var i = 0; i < rows.length; i++) {
    var row = [], cols = rows[i].querySelectorAll("td, th");

        for (var j = 0; j < cols.length; j++)
          row.push(cols[j].innerText);
          if(jez==2){
            csv.push(row.join(","));
          }else{
            csv.push(row.join(";"));
          }
  }
  download_csv(csv.join("\n"), filename+'.csv');
}

function download_csv(csv, filename) {
    var csvFile;
    var downloadLink;

    csvFile = new Blob(["\ufeff",csv], {type: "text/csv;"});
    downloadLink = document.createElement("a");
    downloadLink.download = filename;
    downloadLink.href = window.URL.createObjectURL(csvFile);
    downloadLink.style.display = "none";
    document.body.appendChild(downloadLink);
    downloadLink.click();
}

//setTimeout(() => {
  am5.ready(function() {
  const CSV_FILE_URL = '{{ site.baseurl }}/data/regionalne/indicator_{{ id_map }}-reg.csv';

  fetch(CSV_FILE_URL)
    .then(response => response.text())
    .then(csvText => {
      const data = parseCSV(csvText);

      console.log(data);
      data.forEach(row => {
        delete row["Polska"];
      });

      createchartLine("chartLine",  data.slice(1),"{{ language }}");

      for(let i=0; i<17; i++){
        $('#row-'+i).toggle();
      }

      });


  const CSV_FILE_URL2 = '{{ site.baseurl }}/data/regionalne/indicator_{{ id_map }}-map.csv';

  fetch(CSV_FILE_URL2)
        .then(response => response.text())
        .then(csvText => {
          const data2 = parseCSV(csvText);

          console.log(data2);

          const maxValue = Math.max(
            ...data2.slice(1).flatMap(obj =>
              Object.entries(obj)
                .filter(([key]) => key !== "year")
                .map(([_, val]) => parseFloat(val))
                .filter(v => !isNaN(v))
            )
          );

          console.log(maxValue);

          let lastYearValue = undefined;
          let lastValue = undefined;

          for(let i=2;i<Object.keys(data2[0]).length-1; i++){
            lastYearValue = Object.keys(data2[0]).at(-i);
            console.log(lastYearValue);

            lastValue = Object.values(data2[0]).at(-i);
            console.log(lastValue);

            if(lastValue !== ""){
              break
            }
          }

          createchartBar("chartBar", data2.slice(1), 0,maxValue+5, 0, [lastYearValue],"{{ language }}");
          });
    });
//}, 500);

function addAllBar(){
  const checkboxesBar = document.querySelectorAll('#chooseWojBar input[type="checkbox"]');

  var v = false;
  if(checkboxesBar[0].checked){
    v = true;
  }

  checkboxesBar.forEach((cb, i) => {
    if (cb.value!== 'all') {
      cb.checked = v;
    }
    console.log(cb.value);
    if(!v && cb.value.toUpperCase() === "POLSKA"){
      cb.checked = true;
    }
  });

  updateChartBar();
}

function addAllLine(){
  const checkboxesBar = document.querySelectorAll('#chooseWojLine input[type="checkbox"]');

  var v = false;
  if(checkboxesBar[0].checked){
    v = true;
  }

  checkboxesBar.forEach((cb, i) => {
    if (cb.value!== 'all') {
      cb.checked = v;
    }
    console.log(cb.value);
    if(!v && cb.value.toUpperCase() === "POLSKA"){
      cb.checked = true;
    }
  });

  updateChartLine();
}

function updateChartBar(){

  var yearBoxBar = document.getElementById("yearBoxBar");
  var selectedYear = yearBoxBar.options[yearBoxBar.selectedIndex].value;

  const checkboxesBar = document.querySelectorAll('#chooseWojBar input[type="checkbox"]');
  const checkedValuesBar = [];

  console.log(checkboxesBar);

  checkboxesBar.forEach((cb, i) => {
    if (cb.checked) {
      checkedValuesBar.push(cb.value);
    }
  });

  if(checkedValuesBar[0] === ""){
    checkedValuesBar.push("POLSKA");
    const checkbox = document.getElementById('Polska');
    checkbox.checked = true;
  }
  console.log("Wybrane wartosci");
  console.log(checkedValuesBar);

  am5.ready(function() {
    const CSV_FILE_URL2 = '{{ site.baseurl }}/data/regionalne/indicator_{{ id_map }}-map.csv';

    fetch(CSV_FILE_URL2)
          .then(response => response.text())
          .then(csvText => {
            const data2 = parseCSV(csvText);

            console.log(data2);

            const data3 = [];

            for(let i of data2){
              for(let a of checkedValuesBar){
                console.log(i.REGION);

                if(i.REGION == a.toUpperCase()){
                  data3.push(i);
                }
              }
            }

            const maxValue = Math.max(
              ...data3.flatMap(obj =>
                Object.entries(obj)
                  .filter(([key]) => key !== "year")
                  .map(([_, val]) => parseFloat(val))
                  .filter(v => !isNaN(v))
              )
            );

            console.log(maxValue);

            console.log(data3);

            createchartBar("chartBar", data3, 0, maxValue+5, 0, [selectedYear],"{{ language }}");
            });
      });
}


function updateChartLine(){
  const checkboxes = document.querySelectorAll('#chooseWojLine input[type="checkbox"]');
  const checkedValues = [];


  const tr = document.querySelectorAll('tr');
  console.log(tr);

  checkboxes.forEach((cb,i) => {
    if (cb.checked && cb.value !== 'all') {
      checkedValues.push(cb.value);
      tr[i].style.display = '';
    }
    if (!cb.checked && cb.value !== 'all'){
      tr[i].style.display = 'none';
    }
  });

  if(checkedValues[0] === ""){
    checkedValues.push("Polska");
    const checkbox = document.getElementById('PolskaLineCheckbox');
    checkbox.checked = true;
  }
  checkedValues.push("year");
  console.log(checkedValues);

  am5.ready(function() {
    const CSV_FILE_URL = '{{ site.baseurl }}/data/regionalne/indicator_{{ id_map }}-reg.csv';

    fetch(CSV_FILE_URL)
          .then(response => response.text())
          .then(csvText => {
            const data2 = parseCSV(csvText);

            console.log(data2);

            data2.forEach(row => {
              Object.keys(row).forEach(key => {
                if (!checkedValues.includes(key)) {
                  delete row[key];
                }
              });
            });
            console.log(data2);
            createchartLine("chartLine",  data2.slice(1),"{{ language }}");
          });
    });

}

</script>
